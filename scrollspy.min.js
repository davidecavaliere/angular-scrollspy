"use strict";angular.module("davidecavaliere.angular-scrollspy",[]).value("config",{offset:70,delay:100}).run(["PositionFactory",function(PositionFactory){PositionFactory.refreshPositions(),angular.element(window).bind("scroll",function(){PositionFactory.refreshPositions()})}]).factory("PositionFactory",["$rootScope",function($rootScope){return{position:[],refreshPositions:function(){this.position.documentHeight=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),this.position.windowTop=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,this.position.windowBottom=this.position.windowTop+window.innerHeight}}}]).directive("scrollspyTrigger",function(config,scrollspyConfig,PositionFactory,$log,$rootScope){return{restrict:"A",scope:{scrollspyTrigger:"="},link:function(scope,element,attrs){angular.extend(config,scrollspyConfig.config),scope.checkActive=function(){var offset=parseInt(attrs.scrollspyOffset||config.offset);scope.phase="out";var elementTop=element[0].offsetTop,elementHeight=element[0].offsetHeight,scrollTop=angular.element(document.body)[0].scrollTop+offset,windowHeight=window.innerHeight,windowBottom=scrollTop+window.innerHeight,elementBottom=elementTop+element[0].offsetHeight;windowHeight>elementHeight?elementTop>windowBottom||scrollTop>elementBottom?scope.phase="out":elementBottom>windowBottom?scope.phase="entering":windowBottom>=elementBottom&&elementTop>=scrollTop?scope.phase="in":elementBottom>=scrollTop&&scrollTop>elementTop&&(scope.phase="leaving"):elementTop>windowBottom||scrollTop>elementBottom?scope.phase="out":elementTop>scrollTop?scope.phase="entering":elementBottom>scrollTop&&windowBottom>elementBottom?scope.phase="leaving":scrollTop>=elementTop&&elementBottom>=windowBottom&&(scope.phase="in"),$rootScope.$broadcast("scrollspy:"+scope.scrollspyTrigger,scope.phase)},config.throttle?angular.element(window).bind("scroll",config.throttle(function(){scope.checkActive()},config.delay)):angular.element(window).bind("scroll",function(){scope.checkActive()}),scope.$$postDigest(function(){scope.checkActive()}),angular.element(window).bind("resize",function(){scope.checkActive()}),element.append(scope.phase)}}}).directive("scrollspyReceiver",function($log){return{restrict:"A",scope:{scrollspyReceiver:"="},link:function(scope,element,attrs){scope.$on("scrollspy:"+scope.scrollspyReceiver,function(event,phase){"out"==phase?element.removeClass("active"):"in"==phase?element.addClass("active"):"leaving"==phase&&element.addClass("active")})},controller:function($scope,$element,$attrs){}}}).provider("scrollspyConfig",function(){var self=this;return this.config={},this.$get=function(){var extend={};return extend.config=self.config,extend},this});